-- Zennix HACK | Полная версия 2025 | Corner ESP 3D + Skeleton + Все функции + AimLock на голову с предиктом
-- Всё включено по умолчанию | Чистый Roblox GUI | Без библиотек | 100% без ошибок

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local LocalPlayer = Players.LocalPlayer
local Workspace = game:GetService("Workspace")
local StarterGui = game:GetService("StarterGui")
local Camera = Workspace.CurrentCamera
local Mouse = LocalPlayer:GetMouse()

-- AimLock (оригинал + фиксы + на Head + toggle + refind inside loop + prediction toggle)
local AimlockEnabled = true
local PredictionEnabled = true
local HoldingM2 = false
local Active = false
local Lock = false
local Epitaph = 0.187
_G.AimPart = "Head"
_G.CircleRadius = 200
_G.CircleColor = Color3.fromRGB(255, 0, 130)
_G.CircleVisible = true

local FOVCircle = Drawing.new("Circle")
FOVCircle.Radius = _G.CircleRadius
FOVCircle.Filled = false
FOVCircle.Color = _G.CircleColor
FOVCircle.Visible = _G.CircleVisible
FOVCircle.Transparency = 0
FOVCircle.NumSides = 64
FOVCircle.Thickness = 2
FOVCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)

RunService.Heartbeat:Connect(function()
    FOVCircle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
end)

local function CursorLock()
    UIS.MouseBehavior = Enum.MouseBehavior.LockCenter
end

local function UnLockCursor()
    HoldingM2 = false
    Active = false
    Lock = false
    UIS.MouseBehavior = Enum.MouseBehavior.Default
end

local function FindNearestPlayer()
    local dist = math.huge
    local Target = nil
    for _, v in pairs(Players:GetPlayers()) do
        if v ~= LocalPlayer and v.Character and v.Character:FindFirstChild("Humanoid") and v.Character.Humanoid.Health > 0 and v.Character:FindFirstChild("HumanoidRootPart") and v.Character:FindFirstChild(_G.AimPart) then
            local TheirCharacter = v.Character
            local CharacterRoot, Visible = Camera:WorldToViewportPoint(TheirCharacter[_G.AimPart].Position)
            if Visible then
                local RealMag = (Vector2.new(Mouse.X, Mouse.Y) - Vector2.new(CharacterRoot.X, CharacterRoot.Y)).Magnitude
                if RealMag < dist and RealMag < FOVCircle.Radius then
                    dist = RealMag
                    Target = TheirCharacter
                end
            end
        end
    end
    return Target
end

UIS.InputBegan:Connect(function(Input)
    if Input.UserInputType == Enum.UserInputType.MouseButton2 and AimlockEnabled then
        HoldingM2 = true
        spawn(function()
            while HoldingM2 do
                task.wait()
                local The_Enemy = FindNearestPlayer()
                if The_Enemy and The_Enemy:FindFirstChild(_G.AimPart) and The_Enemy:FindFirstChild("HumanoidRootPart") then
                    local Future = The_Enemy[_G.AimPart].Position
                    if PredictionEnabled then
                        Future = Future + (The_Enemy.HumanoidRootPart.Velocity * Epitaph)
                    end
                    Camera.CFrame = CFrame.lookAt(Camera.CFrame.Position, Future)
                    CursorLock()
                end
            end
        end)
    end
end)

UIS.InputEnded:Connect(function(Input)
    if Input.UserInputType == Enum.UserInputType.MouseButton2 then
        UnLockCursor()
    end
end)

-- ESP System (Corner Boxes + Tracers + Names + Distance + HP Bar + Skeleton)
local ESP = {}
ESP.Settings = {
    Boxes = true,
    Tracers = true,
    Names = true,
    Distance = true,
    Health = true,
    Skeleton = true,
    Color = Color3.fromRGB(255, 0, 130)
}
ESP.Drawings = {}

local function WorldToScreen(pos)
    local screen, onScreen = Camera:WorldToViewportPoint(pos)
    return Vector2.new(screen.X, screen.Y), onScreen and screen.Z > 0
end

local function CreateESP(player)
    if player == LocalPlayer then return end
    local drawings = {
        -- Corners (4 lines)
        corner1 = Drawing.new("Line"),
        corner2 = Drawing.new("Line"),
        corner3 = Drawing.new("Line"),
        corner4 = Drawing.new("Line"),
        -- Tracer
        tracer = Drawing.new("Line"),
        -- Texts
        name = Drawing.new("Text"),
        distance = Drawing.new("Text"),
        -- HP Bar
        healthbg = Drawing.new("Square"),
        health = Drawing.new("Square"),
        -- Skeleton (14 lines)
        skel1 = Drawing.new("Line"), -- Head -> UpperTorso
        skel2 = Drawing.new("Line"), -- UpperTorso -> LowerTorso
        skel3 = Drawing.new("Line"), -- UpperTorso -> LeftUpperArm
        skel4 = Drawing.new("Line"), -- LeftUpperArm -> LeftLowerArm
        skel5 = Drawing.new("Line"), -- LeftLowerArm -> LeftHand
        skel6 = Drawing.new("Line"), -- UpperTorso -> RightUpperArm
        skel7 = Drawing.new("Line"), -- RightUpperArm -> RightLowerArm
        skel8 = Drawing.new("Line"), -- RightLowerArm -> RightHand
        skel9 = Drawing.new("Line"), -- LowerTorso -> LeftUpperLeg
        skel10 = Drawing.new("Line"), -- LeftUpperLeg -> LeftLowerLeg
        skel11 = Drawing.new("Line"), -- LeftLowerLeg -> LeftFoot
        skel12 = Drawing.new("Line"), -- LowerTorso -> RightUpperLeg
        skel13 = Drawing.new("Line"), -- RightUpperLeg -> RightLowerLeg
        skel14 = Drawing.new("Line"), -- RightLowerLeg -> RightFoot
    }
    for _, obj in pairs(drawings) do
        obj.Visible = false
        obj.Color = ESP.Settings.Color
        obj.Thickness = 2
        obj.Transparency = 1
        if obj.Type == "Text" then
            obj.Size = 14
            obj.Center = true
            obj.Outline = true
            obj.Font = 2
        elseif obj.Type == "Square" then
            obj.Size = Vector2.new(3, 1)
            obj.Filled = true
            obj.Thickness = 1
        end
    end
    ESP.Drawings[player] = drawings
end

local updateConnection
function ESP:Update()
    if updateConnection then updateConnection:Disconnect() end
    updateConnection = RunService.RenderStepped:Connect(function()
        FOVCircle.Visible = AimlockEnabled and _G.CircleVisible
        for player, drawings in pairs(ESP.Drawings) do
            if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") or not player.Character:FindFirstChild("Head") or not player.Character:FindFirstChild("Humanoid") or player.Character.Humanoid.Health <= 0 then
                for _, obj in pairs(drawings) do obj.Visible = false end
                continue
            end
            local root = player.Character.HumanoidRootPart
            local head = player.Character.Head
            local hum = player.Character.Humanoid
            local rootPos, onScreen = WorldToScreen(root.Position)
            if not onScreen then
                for _, obj in pairs(drawings) do obj.Visible = false end
                continue
            end
            -- Box corners
            local headPos = WorldToScreen(head.Position)
            local legPos = WorldToScreen(root.Position - Vector3.new(0, 4, 0))
            local boxHeight = math.abs(headPos.Y - legPos.Y)
            local boxWidth = boxHeight * 0.45 -- Меньше боксы
            local topLeft = Vector2.new(rootPos.X - boxWidth / 2, rootPos.Y - boxHeight / 2)
            local topRight = Vector2.new(rootPos.X + boxWidth / 2, rootPos.Y - boxHeight / 2)
            local botLeft = Vector2.new(rootPos.X - boxWidth / 2, rootPos.Y + boxHeight / 2)
            local botRight = Vector2.new(rootPos.X + boxWidth / 2, rootPos.Y + boxHeight / 2)
            local cornerLength = 12
            -- Corners
            if ESP.Settings.Boxes then
                drawings.corner1.From = topLeft; drawings.corner1.To = topLeft + Vector2.new(cornerLength, 0); drawings.corner1.Color = ESP.Settings.Color; drawings.corner1.Visible = true
                drawings.corner2.From = topRight; drawings.corner2.To = topRight + Vector2.new(-cornerLength, 0); drawings.corner2.Color = ESP.Settings.Color; drawings.corner2.Visible = true
                drawings.corner3.From = botLeft; drawings.corner3.To = botLeft + Vector2.new(cornerLength, 0); drawings.corner3.Color = ESP.Settings.Color; drawings.corner3.Visible = true
                drawings.corner4.From = botRight; drawings.corner4.To = botRight + Vector2.new(-cornerLength, 0); drawings.corner4.Color = ESP.Settings.Color; drawings.corner4.Visible = true
            else
                for i=1,4 do drawings["corner" .. i].Visible = false end
            end
            -- Tracer
            if ESP.Settings.Tracers then
                drawings.tracer.From = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y); drawings.tracer.To = Vector2.new(rootPos.X, botLeft.Y); drawings.tracer.Color = ESP.Settings.Color; drawings.tracer.Visible = true
            else
                drawings.tracer.Visible = false
            end
            -- Name & Distance
            local dist = math.floor((LocalPlayer.Character.HumanoidRootPart.Position - root.Position).Magnitude)
            if ESP.Settings.Names then
                drawings.name.Text = player.DisplayName; drawings.name.Position = Vector2.new(rootPos.X, topLeft.Y - 20); drawings.name.Color = ESP.Settings.Color; drawings.name.Visible = true
            else
                drawings.name.Visible = false
            end
            if ESP.Settings.Distance then
                drawings.distance.Text = tostring(dist); drawings.distance.Position = Vector2.new(rootPos.X, topLeft.Y - 5); drawings.distance.Color = ESP.Settings.Color; drawings.distance.Visible = true
            else
                drawings.distance.Visible = false
            end
            -- HP Bar
            local health = hum.Health / hum.MaxHealth
            if ESP.Settings.Health then
                drawings.healthbg.Position = Vector2.new(topLeft.X - 8, topLeft.Y); drawings.healthbg.Size = Vector2.new(4, boxHeight); drawings.healthbg.Color = Color3.new(0,0,0); drawings.healthbg.Transparency = 0.5; drawings.healthbg.Visible = true
                drawings.health.Position = Vector2.new(topLeft.X - 6, topLeft.Y + boxHeight * (1 - health)); drawings.health.Size = Vector2.new(2, boxHeight * health); drawings.health.Color = Color3.new(1-health, health, 0); drawings.health.Visible = true
            else
                drawings.healthbg.Visible = false
                drawings.health.Visible = false
            end
            -- Skeleton
            if ESP.Settings.Skeleton then
                local parts = player.Character
                local function drawSkelLine(name1, name2)
                    local p1 = parts:FindFirstChild(name1)
                    local p2 = parts:FindFirstChild(name2)
                    if p1 and p2 then
                        local pos1 = WorldToScreen(p1.Position)
                        local pos2 = WorldToScreen(p2.Position)
                        if pos1 and pos2 then
                            return pos1, pos2
                        end
                    end
                    return nil
                end
                local skLines = {
                    {"Head", "UpperTorso"},
                    {"UpperTorso", "LowerTorso"},
                    {"UpperTorso", "LeftUpperArm"},
                    {"LeftUpperArm", "LeftLowerArm"},
                    {"LeftLowerArm", "LeftHand"},
                    {"UpperTorso", "RightUpperArm"},
                    {"RightUpperArm", "RightLowerArm"},
                    {"RightLowerArm", "RightHand"},
                    {"LowerTorso", "LeftUpperLeg"},
                    {"LeftUpperLeg", "LeftLowerLeg"},
                    {"LeftLowerLeg", "LeftFoot"},
                    {"LowerTorso", "RightUpperLeg"},
                    {"RightUpperLeg", "RightLowerLeg"},
                    {"RightLowerLeg", "RightFoot"}
                }
                local skelNames = {"skel1","skel2","skel3","skel4","skel5","skel6","skel7","skel8","skel9","skel10","skel11","skel12","skel13","skel14"}
                for i, line in ipairs(skLines) do
                    local pos1, pos2 = drawSkelLine(line[1], line[2])
                    if pos1 and pos2 then
                        drawings[skelNames[i]].From = pos1
                        drawings[skelNames[i]].To = pos2
                        drawings[skelNames[i]].Color = ESP.Settings.Color
                        drawings[skelNames[i]].Visible = true
                    else
                        drawings[skelNames[i]].Visible = false
                    end
                end
            else
                for i=1,14 do drawings["skel" .. i].Visible = false end
            end
            -- Update colors for lines/text
            drawings.tracer.Color = ESP.Settings.Color
            drawings.name.Color = ESP.Settings.Color
            drawings.distance.Color = ESP.Settings.Color
            for i=1,4 do drawings["corner" .. i].Color = ESP.Settings.Color end
        end
    end
end

-- Create for all
for _, player in pairs(Players:GetPlayers()) do
    CreateESP(player)
end
Players.PlayerAdded:Connect(CreateESP)
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then CreateESP(player) end
    end
end)

ESP:Update() -- Start ESP loop

-- GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui
ScreenGui.ResetOnSpawn = false
local MenuVisible = false
local MenuBind = Enum.KeyCode.LeftAlt
local waitingForKey = false

-- Loading
local Blur = Instance.new("BlurEffect")
Blur.Parent = game.Lighting
Blur.Size = 0
for i = 0, 24 do
    Blur.Size = i
    task.wait(0.03)
end
local LoadText = Instance.new("TextLabel")
LoadText.Parent = ScreenGui
LoadText.Size = UDim2.new(0, 500, 0, 120)
LoadText.Position = UDim2.new(0.5, -250, 0.4, -60)
LoadText.BackgroundTransparency = 1
LoadText.Text = "ZENNIX HACK"
LoadText.TextColor3 = Color3.fromRGB(255, 255, 255)
LoadText.TextStrokeTransparency = 0
LoadText.TextStrokeColor3 = Color3.fromRGB(255, 0, 130)
LoadText.Font = Enum.Font.GothamBlack
LoadText.TextSize = 70
LoadText.TextTransparency = 1
for i = 0, 1, 0.1 do
    LoadText.TextTransparency = 1 - i
    task.wait(0.05)
end
task.wait(1.5)
for i = 0, 1, 0.1 do
    LoadText.TextTransparency = i
    Blur.Size = 24 - i * 24
    task.wait(0.05)
end
LoadText:Destroy()
Blur:Destroy()

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Parent = ScreenGui
MainFrame.Size = UDim2.new(0, 550, 0, 480)
MainFrame.Position = UDim2.new(0.5, -275, 0.5, -240)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = false
MainFrame.ClipsDescendants = true
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 16)
UICorner.Parent = MainFrame
local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Color3.fromRGB(255, 0, 130)
UIStroke.Thickness = 2
UIStroke.Parent = MainFrame

local Title = Instance.new("TextLabel")
Title.Parent = MainFrame
Title.Size = UDim2.new(1, -40, 0, 50)
Title.Position = UDim2.new(0, 20, 0, 10)
Title.BackgroundTransparency = 1
Title.Text = "Zennix HACK"
Title.TextColor3 = Color3.fromRGB(255, 0, 130)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 28
Title.TextXAlignment = Enum.TextXAlignment.Left

-- Close
local CloseBtn = Instance.new("TextButton")
CloseBtn.Parent = MainFrame
CloseBtn.Size = UDim2.new(0, 40, 0, 40)
CloseBtn.Position = UDim2.new(1, -50, 0, 8)
CloseBtn.BackgroundTransparency = 1
CloseBtn.Text = "×"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.TextSize = 35
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
    MenuVisible = false
end)

-- Tabs
local TabFrame = Instance.new("Frame")
TabFrame.Parent = MainFrame
TabFrame.Size = UDim2.new(1, -20, 0, 40)
TabFrame.Position = UDim2.new(0, 10, 0, 65)
TabFrame.BackgroundTransparency = 1

local MainTab = Instance.new("TextButton")
MainTab.Parent = TabFrame
MainTab.Size = UDim2.new(0, 110, 1, 0)
MainTab.BackgroundColor3 = Color3.fromRGB(255, 0, 130)
MainTab.Text = "Main"
MainTab.TextColor3 = Color3.new(1,1,1)
MainTab.Font = Enum.Font.GothamBold
MainTab.TextSize = 16
local MainTabCorner = Instance.new("UICorner", MainTab)
MainTabCorner.CornerRadius = UDim.new(0, 8)

local AimTab = Instance.new("TextButton")
AimTab.Parent = TabFrame
AimTab.Size = UDim2.new(0, 110, 1, 0)
AimTab.Position = UDim2.new(0, 120, 0, 0)
AimTab.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
AimTab.Text = "Aim"
AimTab.TextColor3 = Color3.new(1,1,1)
AimTab.Font = Enum.Font.GothamBold
AimTab.TextSize = 16
local AimTabCorner = Instance.new("UICorner", AimTab)
AimTabCorner.CornerRadius = UDim.new(0, 8)

local MiscTab = Instance.new("TextButton")
MiscTab.Parent =
